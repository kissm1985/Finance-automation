name: Quantum DCA Strategy

on:
  workflow_dispatch:

jobs:
  run-dca-strategy:
    runs-on: ubuntu-latest

    steps:
    - name: Kód letöltése
      uses: actions/checkout@v3

    - name: Python telepítése
      uses: actions/setup-python@v4
      with:
        python-version: 3.11

    - name: Függőségek telepítése
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Script futtatása
      run: python main.py

    - name: Fájlok listázása
      run: ls -lah

    - name: E-mail küldése az eredményekkel
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 465
        username: ${{ secrets.MAIL_USERNAME }}
        password: ${{ secrets.MAIL_PASSWORD }}
        subject: Kvantum DCA eredmények
        to: ${{ secrets.MAIL_RECEIVER }}
        from: Kvantum Portfólió Optimalizáló
        content_type: text/plain
        body: |
          Kedves István,

          A kvantum-alapú DCA szimuláció és visszateszt lefutott.

          A csatolt fájlokban találod a vásárlási naplót és az összefoglalót.

          Üdv,
          GitHub Actions bot
        attachments: |
          buy_log.txt
          backtest_summary.txt
